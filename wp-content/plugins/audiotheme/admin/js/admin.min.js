window.audiotheme=window.audiotheme||{},function(a){_.extend(audiotheme,{template:_.memoize(function(b){var c,d={evaluate:/<#([\s\S]+?)#>/g,interpolate:/\{\{\{([\s\S]+?)\}\}\}/g,escape:/\{\{([^\}]+?)\}\}(?!\})/g,variable:"data"};return function(e){return(c=c||_.template(a("#tmpl-"+b).html(),null,d))(e)}}),post:function(a,b){return audiotheme.ajax({data:_.isObject(a)?a:_.extend(b||{},{action:a})})},ajax:function(b,c){return _.isObject(b)?c=b:(c=c||{},c.data=_.extend(c.data||{},{action:b})),c=_.defaults(c||{},{type:"POST",url:ajaxurl,context:this}),a.Deferred(function(b){c.success&&b.done(c.success),c.error&&b.fail(c.error),delete c.success,delete c.error,a.ajax(c).done(function(a){"1"!==a&&1!==a||(a={success:!0}),_.isObject(a)&&!_.isUndefined(a.success)?b[a.success?"resolveWith":"rejectWith"](this,[a.data]):b.rejectWith(this,[a])}).fail(function(){b.rejectWith(this,arguments)})}).promise()}})}(jQuery),jQuery(function(a){a(".wrap").on("focus",".audiotheme-input-append input",function(){a(this).parent().addClass("is-focused")}).on("blur",".audiotheme-input-append input",function(){a(this).parent().removeClass("is-focused")})}),jQuery(function(a){var b=null,c=null,d=null;a("body").on("click",".thickbox",function(){var e=a(this),f=e.data("insert-field"),g=e.data("insert-button-text");clearInterval(d),"undefined"!=typeof f&&(b=f),"undefined"!=typeof g&&(c=g,d=setInterval(function(){var e=a("#TB_iframeContent").contents().find('.button[name^="send"], #insertonlybutton');e.val(c),b.length&&e.off("click").on("click.audiotheme",function(e){var f,g=a(this),h=g.closest("table");e.preventDefault(),h.find("#src").length?f=h.find("#src").val():h.find(".urlfile").length&&(f=a(this).closest("table").find(".urlfile").data("link-url")),jQuery("#"+b).val(f),tb_remove(),b=null,c=null,clearInterval(d)})},500))})}),function(a){var b={init:function(b){var c={items:null};return b&&a.extend(c,b),this.each(function(){var b,d,e=a(this),f=e.find(".audiotheme-repeater-items");e.data("item-template-id")?(d=audiotheme.template(e.data("item-template-id")),c.items&&(e.audiothemeRepeater("clearList"),a.each(c.items,function(a,b){f.append(d(b).replace(/__i__/g,a))})),b=d({}),b=a(b.replace(/__i__/g,"0"))):b=e.find(".audiotheme-repeater-item:eq(0)").clone(),e.data("itemIndex",e.find(".audiotheme-repeater-item").length||0),e.data("itemTemplate",b),e.audiothemeRepeater("updateIndex"),f.sortable({axis:"y",forceHelperSize:!0,forcePlaceholderSize:!0,helper:function(b,c){var d=c.clone();return d.children().each(function(b){a(this).width(c.children().eq(b).width())}),d},update:function(){e.audiothemeRepeater("updateIndex")},change:function(){e.find(".audiotheme-repeater-sort-warning").fadeIn("slow")}}),e.find(".audiotheme-repeater-add-item").on("click",function(b){b.preventDefault(),a(this).closest(".audiotheme-repeater").audiothemeRepeater("addItem")}),e.on("click",".audiotheme-repeater-remove-item",function(b){var c=a(this).closest(".audiotheme-repeater");b.preventDefault(),a(this).closest(".audiotheme-repeater-item").remove(),c.audiothemeRepeater("updateIndex")}),e.on("blur","input,select,textarea",function(){a(this).closest(".audiotheme-repeater").find(".audiotheme-repeater-item").removeClass("audiotheme-repeater-active-item")}).on("focus","input,select,textarea",function(){a(this).closest(".audiotheme-repeater-item").addClass("audiotheme-repeater-active-item").siblings().removeClass("audiotheme-repeater-active-item")})})},addItem:function(){var b=a(this),c=b.data("itemIndex"),d=b.data("itemTemplate");b.audiothemeRepeater("clearList"),b.find(".audiotheme-repeater-items").append(d.clone()).children(":last-child").find("input,select,textarea").each(function(){var b=a(this);b.attr("name",b.attr("name").replace("[0]","["+c+"]"))}).end().find(".audiotheme-clear-on-add").val("").end().find(".audiotheme-remove-on-add").remove().end().find(".audiotheme-show-on-add").show().end().find(".audiotheme-hide-on-add").hide().end(),b.data("itemIndex",c+1).audiothemeRepeater("updateIndex"),b.trigger("addItem.audiotheme",[b.find(".audiotheme-repeater-items").children().last()])},clearList:function(){var b=a(this).find(".audiotheme-repeater-items");b.hasClass("is-empty")&&b.removeClass("is-empty").html("")},updateIndex:function(){a(".audiotheme-repeater-index",this).each(function(b){a(this).text(b+1+".")})}};a.fn.audiothemeRepeater=function(c){return b[c]?b[c].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof c&&c?void a.error("Method "+c+" does not exist on jQuery.audiothemeRepeater"):b.init.apply(this,arguments)}}(jQuery);